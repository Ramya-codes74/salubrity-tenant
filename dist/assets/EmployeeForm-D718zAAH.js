import{b as y,a as w,c as E,r as d,j as e}from"./index-DTwl35de.js";import{l as C,g as P,s as g}from"./employeesStorage-TR-DAmyG.js";import{E as S}from"./EmailPreviewModal-qbgETZFj.js";const k=r=>new Promise((x,c)=>{const t=new FileReader;t.readAsDataURL(r),t.onload=()=>x(t.result),t.onerror=n=>c(n)}),A=({mode:r="add"})=>{const{getRolesList:x}=y(),c=x(),{id:t}=w(),n=E(),[m,h]=d.useState([]),[l,i]=d.useState({firstName:"",lastName:"",email:"",phone:"",role:c[0],avatar:null,projects:[]}),[p,j]=d.useState(null);d.useEffect(()=>{h(C())},[]),d.useEffect(()=>{if(r==="edit"&&m.length&&t){const a=m.find(s=>s.id===t);a?i({firstName:a.firstName,lastName:a.lastName,email:a.email,phone:a.phone,role:a.role,avatar:a.avatar||null,projects:a.projects||[]}):n("/employees")}},[r,m,t,n]);const v=async a=>{if(!a)return;const s=await k(a);i(o=>({...o,avatar:s}))},N=async a=>{if(a.preventDefault(),!l.firstName||!l.email){alert("First name and email are required");return}if(r==="add"){const s=P(m),o=Math.random().toString(36).slice(-8),u={id:s,firstName:l.firstName,lastName:l.lastName,email:l.email,phone:l.phone,role:l.role,status:"Invitation Sent",avatar:l.avatar||null,projects:l.projects||[],createdAt:new Date().toISOString()},f=[u,...m];g(f),h(f);const b={email:u.email,password:o,name:`${u.firstName} ${u.lastName}`};n("/employees/list",{state:{emailPreview:b}})}else{const s=m.map(o=>o.id===t?{...o,...l}:o);g(s),h(s),n("/employees/list")}};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:r==="add"?"Add Employee":"Edit Employee"}),e.jsx("p",{className:"text-gray-500",children:"Capture profile and project assignments."})]})}),e.jsxs("form",{onSubmit:N,className:"bg-white dark:bg-gray-800 rounded-xl p-6 border space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"First name"}),e.jsx("input",{value:l.firstName,onChange:a=>i(s=>({...s,firstName:a.target.value})),className:"w-full p-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Last name"}),e.jsx("input",{value:l.lastName,onChange:a=>i(s=>({...s,lastName:a.target.value})),className:"w-full p-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:l.email,onChange:a=>i(s=>({...s,email:a.target.value})),className:"w-full p-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{value:l.phone,onChange:a=>i(s=>({...s,phone:a.target.value})),className:"w-full p-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),e.jsx("select",{value:l.role,onChange:a=>i(s=>({...s,role:a.target.value})),className:"w-full p-2 border rounded-lg",children:c.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Profile image"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"w-24 h-24 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center cursor-pointer",children:[l.avatar?e.jsx("img",{alt:"avatar",src:l.avatar,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-sm text-gray-500",children:"Upload"}),e.jsx("input",{onChange:a=>a.target.files&&v(a.target.files[0]),type:"file",accept:"image/*",className:"hidden"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Recommended 400x400px, JPG/PNG."})]})]})]}),e.jsx("div",{}),e.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>n("/employees"),className:"px-4 py-2 border rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:r==="add"?"Create & Invite":"Save"})]})]}),p&&e.jsx(S,{to:p.email,name:p.name,password:p.password,onClose:()=>j(null)})]})};export{A as default};
