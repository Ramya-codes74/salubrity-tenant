import{a as p,c as v,r,j as e}from"./index-DTwl35de.js";import{f as b,u as N}from"./analysesStorage-DB-LTlel.js";import{g as y,P as f}from"./PieChart-D4tmB4au.js";const l=["#4f46e5","#06b6d4","#f59e0b","#ef4444","#10b981"],S={hairImageChoice:"Hair image",familyHistory:"Family history",dandruff:"Dandruff",sleep:"Sleep quality",stress:"Stress (1-10)",gastric:"Gastric issues?",gastricDetails:"Gastric details",energy:"Energy (1-10)",medication:"Medication?",medicationDetails:"Medications",scalpImage:"Scalp image"},P=()=>{const{id:n}=p(),x=v(),[i,h]=r.useState(null),[s,d]=r.useState(null),[w,g]=r.useState("");if(r.useEffect(()=>{const t=b(n);if(t){if(h(t),t.report)d(t.report);else{const a=y(t);d(a),N(n,{report:a})}g(t.clinicianNotes||"")}},[n]),!i||!s)return e.jsx("div",{className:"p-6",children:"Loading report..."});const o=i.scalpImageBase64||i.answers?.scalpImage||null;let c=[];s.nutrition&&s.nutrition.tags&&s.nutrition.tags.length?c=s.nutrition.tags.map((t,a)=>({label:t,value:1,color:l[a%l.length]})):c=[{label:"Protein & Amino acids",value:30,color:l[0]},{label:"Iron & Micronutrients",value:25,color:l[1]},{label:"Omega-3 & Fats",value:15,color:l[2]},{label:"Vitamins (D/B12)",value:20,color:l[3]},{label:"Other (Zinc/selenium)",value:10,color:l[4]}];const m=i.answers||{},j=i.actor||(i.createdByEmployee?"Employee":"Self");return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Hair Report — ",i.testId]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Customer: ",i.customerSnapshot?.name||"Guest"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x("/analysis/history"),className:"px-3 py-2 border rounded",children:"Back to History"}),e.jsx("button",{onClick:()=>{},className:"px-3 py-2 bg-blue-600 text-white rounded",children:"Download PDF"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-white p-4 rounded border",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Summary"}),e.jsx("p",{className:"text-sm text-gray-600",children:(s.hair_loss?.causes?.length?s.hair_loss.causes.join("; ")+". ":"")+(s.recommendations?.slice(0,3).join(". ")||"")}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hair Density"}),e.jsx("div",{className:"text-lg font-semibold",children:s.metrics.hair_density.value}),e.jsx("div",{className:"text-xs text-gray-500",children:s.metrics.hair_density.interpretation.label})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hair Thickness"}),e.jsx("div",{className:"text-lg font-semibold",children:s.metrics.hair_thickness.value}),e.jsx("div",{className:"text-xs text-gray-500",children:s.metrics.hair_thickness.interpretation.label})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Damage Level"}),e.jsx("div",{className:"text-lg font-semibold",children:s.metrics.damage_level.value}),e.jsx("div",{className:"text-xs text-gray-500",children:s.metrics.damage_level.interpretation.label})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Scalp condition"}),e.jsx("div",{className:"text-lg font-semibold",children:s.metrics.scalp_condition.value}),e.jsx("div",{className:"text-xs text-gray-500",children:s.metrics.scalp_condition.interpretation.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Uploaded Scalp Image"}),o?e.jsx("img",{src:o,alt:"scalp upload",className:"w-64 h-64 object-cover rounded border"}):e.jsx("div",{className:"text-sm text-gray-500",children:"No scalp image available"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Nutrition Overview (sample)"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{style:{width:140},children:e.jsx(f,{data:c,size:140})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-700 mb-2",children:s.nutrition.aiNarrative||"Protein-rich diet recommended; emphasis on iron, vitamin D and B12 for hair strength."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Top nutrients to support hair:"}),e.jsxs("ul",{className:"list-disc ml-5 text-sm mt-2",children:[e.jsx("li",{children:"Protein & amino acids (keratin precursors)"}),e.jsx("li",{children:"Iron / ferritin — for hair growth"}),e.jsx("li",{children:"Vitamin D & B12 — energy & follicle health"}),e.jsx("li",{children:"Zinc — scalp & hair shaft integrity"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Submitted symptoms & questionnaire"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[Object.keys(m).length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No responses found."}),Object.entries(m).map(([t,a])=>{if(t==="scalpImage")return null;const u=S[t]||t;return e.jsxs("div",{className:"p-2 border rounded",children:[e.jsx("div",{className:"text-xs text-gray-500",children:u}),e.jsx("div",{className:"font-medium",children:String(a||"—")})]},t)})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Recommendations"}),e.jsx("ol",{className:"list-decimal ml-5 text-sm mt-2",children:s.recommendations.map((t,a)=>e.jsx("li",{children:t},a))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold",children:"Suggested blood tests"}),e.jsx("ul",{className:"list-disc ml-5 text-sm mt-2",children:s.bloodTests.map(t=>e.jsx("li",{children:t},t))})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border mb-6",children:[e.jsx("h3",{className:"font-semibold",children:"Details"}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Test ID:"})," ",i.testId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(i.createdAt).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Performed by:"})," ",j]})]})]})]})};export{P as default};
